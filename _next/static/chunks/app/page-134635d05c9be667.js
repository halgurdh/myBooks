(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1391:(e,t,a)=>{Promise.resolve().then(a.bind(a,8847))},8847:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),r=a(2115);function n(e){let{books:t,loading:a,page:r,totalPages:n,setPage:l}=e;return a?(0,s.jsx)("div",{className:"text-center text-gray-500",children:"Loading recommendations..."}):0===t.length?(0,s.jsx)("div",{className:"text-center text-gray-500",children:"No recommendations found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(e=>{var t;return(0,s.jsxs)("li",{className:"flex flex-col bg-white border rounded-lg shadow-sm p-4",children:[(0,s.jsx)("img",{src:"https://covers.openlibrary.org/b/id/".concat(e.cover_i,"-M.jpg"),alt:e.title,className:"w-full h-48 object-cover rounded-md mb-4"}),(0,s.jsx)("h2",{className:"text-lg font-medium mb-1",children:e.title}),(0,s.jsxs)("p",{className:"text-sm mb-1",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Author(s): "}),(null==(t=e.author_name)?void 0:t.join(", "))||"Unknown"]}),(0,s.jsxs)("p",{className:"text-sm mb-1",children:[(0,s.jsx)("span",{className:"font-semibold",children:"First Published: "}),e.first_publish_year||"N/A"]}),(0,s.jsxs)("p",{className:"text-sm mb-2",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Rating: "}),null!=e.rating?(0,s.jsxs)("span",{className:"text-yellow-600 font-bold",children:[e.rating.toFixed(2)," / 5"]}):(0,s.jsx)("span",{className:"text-gray-400",children:"No rating"})]}),(0,s.jsx)("a",{href:"https://openlibrary.org".concat(e.key),target:"_blank",rel:"noopener noreferrer",className:"mt-auto text-blue-600 hover:underline text-sm",children:"View on Open Library"})]},e.key)})}),(0,s.jsxs)("div",{className:"flex justify-center items-center gap-4 mt-8",children:[(0,s.jsx)("button",{onClick:()=>l(Math.max(1,r-1)),disabled:1===r,className:"px-4 py-2 rounded-lg border ".concat(1===r?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:"Previous"}),(0,s.jsxs)("span",{className:"text-sm",children:["Page ",r]}),(0,s.jsx)("button",{onClick:()=>l(r+1),disabled:r===n||t.length<16,className:"px-4 py-2 rounded-lg border ".concat(r===n||t.length<16?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:"Next"})]})]})}let l=["","Science Fiction","Fantasy","Mystery","Romance","Horror","Biography","History","Children","Young Adult","Thriller","Adventure","Poetry","Drama","Comics","Art","Travel"],o=async e=>{let t=await fetch("https://api.datamuse.com/words?rel_syn=".concat(encodeURIComponent(e)));return(await t.json()).map(e=>e.word)},i=async(e,t,a,s)=>{let r=e.map(encodeURIComponent).join("+OR+"),n="https://openlibrary.org/search.json?q=".concat(r,"&limit=").concat(16,"&page=").concat(t);a&&(n+="&first_publish_year=".concat(a)),s&&(n+="&subject=".concat(encodeURIComponent(s)));let l=await fetch(n),o=await l.json();return{books:o.docs.filter(e=>e.cover_i&&e.key).map(e=>({...e,work_key:e.key.replace(/^\/works\//,""),subject:e.subject})),numFound:o.numFound}},c=async e=>{try{var t;let a=await fetch("https://openlibrary.org/works/".concat(e,"/ratings.json"));if(!a.ok)return null;let s=await a.json();return"number"==typeof(null==(t=s.summary)?void 0:t.average)?s.summary.average:null}catch(e){return null}};function d(){let[e,t]=(0,r.useState)("adventure"),[a,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[h,g]=(0,r.useState)("adventure"),[x,p]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[j,f]=(0,r.useState)([]),[w,v]=(0,r.useState)([]),[N,k]=(0,r.useState)(!1),[_,S]=(0,r.useState)(1),[C,P]=(0,r.useState)(0);(0,r.useEffect)(()=>{(async()=>{k(!0);let e=await o(h),t=Array.from(new Set([h,...e])).slice(0,5);v(t);let{books:a,numFound:s}=await i(t,_,x,b),r=await Promise.all(a.map(async e=>{if(!e.work_key)return{...e,rating:null};let t=await c(e.work_key);return{...e,rating:t}}));r.sort((e,t)=>null==e.rating&&null==t.rating?0:null==e.rating?1:null==t.rating?-1:t.rating-e.rating),f(r),P(s),k(!1)})()},[h,x,b,_]);let R=Math.ceil(C/16);return(0,s.jsxs)("main",{className:"max-w-7xl mx-auto p-4 font-sans",children:[(0,s.jsx)("h1",{className:"text-3xl font-semibold text-center mb-6",children:"Book Recommendations (with Synonyms & Ratings)"}),(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault(),S(1),g(e),p(a),y(u)},className:"flex flex-wrap justify-center mb-8 gap-2",autoComplete:"off",children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter a topic or keyword...",className:"w-full max-w-xs px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring focus:border-blue-400"}),(0,s.jsx)("input",{type:"number",value:a,onChange:e=>d(e.target.value),placeholder:"Year (exact)",className:"w-32 px-4 py-2 border rounded-lg shadow-sm",min:0}),(0,s.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-40 px-4 py-2 border rounded-lg shadow-sm",children:[(0,s.jsx)("option",{value:"",children:"All Genres"}),l.filter(e=>e).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition",children:"Search"})]}),w.length>1&&(0,s.jsxs)("div",{className:"text-center mb-4 text-sm text-gray-600",children:["Searching for: ",(0,s.jsx)("span",{className:"font-semibold",children:w.join(", ")})]}),(0,s.jsx)(n,{books:j,loading:N,page:_,totalPages:R,setPage:S})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(1391)),_N_E=e.O()}]);