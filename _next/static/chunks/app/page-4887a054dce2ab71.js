(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1391:(e,t,a)=>{Promise.resolve().then(a.bind(a,8847))},8847:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115);function n(e){let{books:t,loading:a,page:s,totalPages:n,setPage:l}=e;return a?(0,r.jsx)("div",{className:"text-center text-gray-500",children:"Loading recommendations..."}):0===t.length?(0,r.jsx)("div",{className:"text-center text-gray-500",children:"No recommendations found."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("ul",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(e=>{var t;return(0,r.jsxs)("li",{className:"flex flex-col bg-white border rounded-lg shadow-sm p-4",children:[(0,r.jsx)("img",{src:"https://covers.openlibrary.org/b/id/".concat(e.cover_i,"-M.jpg"),alt:e.title,className:"w-full h-48 object-cover rounded-md mb-4"}),(0,r.jsx)("h2",{className:"text-lg font-medium mb-1",children:e.title}),(0,r.jsxs)("p",{className:"text-sm mb-1",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Author(s): "}),(null==(t=e.author_name)?void 0:t.join(", "))||"Unknown"]}),(0,r.jsxs)("p",{className:"text-sm mb-1",children:[(0,r.jsx)("span",{className:"font-semibold",children:"First Published: "}),e.first_publish_year||"N/A"]}),(0,r.jsxs)("p",{className:"text-sm mb-2",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Rating: "}),null!=e.rating?(0,r.jsxs)("span",{className:"text-yellow-600 font-bold",children:[e.rating.toFixed(2)," / 5"]}):(0,r.jsx)("span",{className:"text-gray-400",children:"No rating"})]}),(0,r.jsx)("a",{href:"https://openlibrary.org".concat(e.key),target:"_blank",rel:"noopener noreferrer",className:"mt-auto text-blue-600 hover:underline text-sm",children:"View on Open Library"})]},e.key)})}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-4 mt-8",children:[(0,r.jsx)("button",{onClick:()=>l(Math.max(1,s-1)),disabled:1===s,className:"px-4 py-2 rounded-lg border ".concat(1===s?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:"Previous"}),(0,r.jsxs)("span",{className:"text-sm",children:["Page ",s]}),(0,r.jsx)("button",{onClick:()=>l(s+1),disabled:s===n||t.length<16,className:"px-4 py-2 rounded-lg border ".concat(s===n||t.length<16?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:"Next"})]})]})}let l=["","Science Fiction","Fantasy","Mystery","Romance","Horror","Biography","History","Children","Young Adult","Thriller","Adventure","Poetry","Drama","Comics","Art","Travel"],o=async e=>{let t=await fetch("https://api.datamuse.com/words?rel_syn=".concat(encodeURIComponent(e)));return(await t.json()).map(e=>e.word)},i=async(e,t,a,r,s)=>{let n=e.map(encodeURIComponent).join("+OR+"),l="https://openlibrary.org/search.json?q=".concat(n,"&limit=").concat(16,"&page=").concat(t);a&&(l+="&first_publish_year=".concat(a)),r&&(l+="&first_publish_year=".concat(r)),s&&(l+="&subject=".concat(encodeURIComponent(s)));let o=await fetch(l),i=await o.json();return{books:i.docs.filter(e=>e.cover_i&&e.key).map(e=>({...e,work_key:e.key.replace(/^\/works\//,""),subject:e.subject})),numFound:i.numFound}},c=async e=>{try{var t;let a=await fetch("https://openlibrary.org/works/".concat(e,"/ratings.json"));if(!a.ok)return null;let r=await a.json();return"number"==typeof(null==(t=r.summary)?void 0:t.average)?r.summary.average:null}catch(e){return null}};function u(){let[e,t]=(0,s.useState)("adventure"),[a,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[h,g]=(0,s.useState)(""),[p,x]=(0,s.useState)("adventure"),[b,y]=(0,s.useState)({yearFrom:"",yearTo:"",genre:""}),[f,j]=(0,s.useState)([]),[w,v]=(0,s.useState)([]),[N,k]=(0,s.useState)(!1),[_,S]=(0,s.useState)(1),[C,F]=(0,s.useState)(0);(0,s.useEffect)(()=>{(async()=>{k(!0);let e=await o(p),t=Array.from(new Set([p,...e])).slice(0,5);v(t);let{books:a,numFound:r}=await i(t,_,b.yearFrom,b.yearTo,b.genre),s=await Promise.all(a.map(async e=>{if(!e.work_key)return{...e,rating:null};let t=await c(e.work_key);return{...e,rating:t}}));s.sort((e,t)=>null==e.rating&&null==t.rating?0:null==e.rating?1:null==t.rating?-1:t.rating-e.rating),j(s),F(r),k(!1)})()},[p,b,_]);let P=Math.ceil(C/16);return(0,r.jsxs)("main",{className:"max-w-7xl mx-auto p-4 font-sans",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold text-center mb-6",children:"Book Recommendations (with Synonyms & Ratings)"}),(0,r.jsxs)("form",{onSubmit:t=>{t.preventDefault(),S(1),x(e),y({yearFrom:a,yearTo:d,genre:h})},className:"flex flex-wrap justify-center mb-8 gap-2",autoComplete:"off",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter a topic or keyword...",className:"w-full max-w-xs px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring focus:border-blue-400"}),(0,r.jsx)("input",{type:"number",value:a,onChange:e=>u(e.target.value),placeholder:"Year from",className:"w-28 px-4 py-2 border rounded-lg shadow-sm",min:0}),(0,r.jsx)("input",{type:"number",value:d,onChange:e=>m(e.target.value),placeholder:"Year to",className:"w-28 px-4 py-2 border rounded-lg shadow-sm",min:0}),(0,r.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"w-40 px-4 py-2 border rounded-lg shadow-sm",children:[(0,r.jsx)("option",{value:"",children:"All Genres"}),l.filter(e=>e).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition",children:"Search"})]}),w.length>1&&(0,r.jsxs)("div",{className:"text-center mb-4 text-sm text-gray-600",children:["Searching for: ",(0,r.jsx)("span",{className:"font-semibold",children:w.join(", ")})]}),(0,r.jsx)(n,{books:f,loading:N,page:_,totalPages:P,setPage:S})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(1391)),_N_E=e.O()}]);